@model WebForum.Models.ViewModels.TopicDetailsViewModel

@{
    ViewData["Title"] = Model.Topic.Title;
}

<h2>@Model.Topic.Title</h2>

<div>
    <p>@Model.Topic.Content</p>
    <p>Posted by: @Model.Topic.User.UserName on @Model.Topic.CreatedAt.ToString("MMMM dd, yyyy")</p>
</div>

<hr />

<h3>Posts</h3>
@foreach (var post in Model.Posts)
{
    <div>
        <p>@post.Content</p>
        <p>Posted by: @post.User.UserName on @post.CreatedAt.ToString("MMMM dd, yyyy")</p>
        <p>Rating: @post.Rating</p> <!-- Fix Rating property -->
    </div>
}

<hr />

@if (User.Identity.IsAuthenticated)
{
    <h4>Add a post</h4>
    <form asp-action="CreatePost" method="post">
        <input type="hidden" asp-for="Topic.Id" />
        <div class="form-group">
            <textarea asp-for="NewPost.Content" class="form-control"></textarea>
            <span asp-validation-for="NewPost.Content" class="text-danger"></span>
        </div>
        <button type="submit" class="btn btn-primary">Post</button>
    </form>
}
